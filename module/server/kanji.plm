# $Id$
# copyright (c)1997-2000 Yoshinori Hasegawa <hasegawa@madoka.org>

package server_kanji;

$_ = 'server_kanji';

sub initialize {
}

sub server_read {
  local($serverno, $line) = @_;
  foreach $kanji (&'property($'userno[$serverno], 'input')) {
    foreach $code (split(/\,/, "\L$kanji\E")) {
      if ($code eq 'euc') {
        $line = &'euc_euc($line);
      } elsif ($code eq 'jis') {
        $line = &'jis_euc($line);
      } elsif ($code eq 'sjis') {
        $line = &'sjis_euc($line);
      }
    }
  }
  return $line;
}

sub server_write {
  local($serverno, $line) = @_;
  local($kanji, $code);
  $kanji = &'property($'userno[$serverno], 'output');
  if ($kanji) {
    $code = (split(/\,/, "\L$kanji\E"))[0];
    if ($kanji eq 'euc') {
      $line = &'euc_euc($line);
    } elsif ($kanji eq 'jis') {
      $line = &'euc_jis($line);
    } elsif ($kanji eq 'sjis') {
      $line = &'euc_sjis($line);
    }
  }
  return $line;
}

